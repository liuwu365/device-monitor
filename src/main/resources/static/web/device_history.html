<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title></title>
    <meta name="format-detection" content="telephone=no" />
    <meta http-equiv="x-rim-auto-match" content="none"/>
    <meta http-equiv="pragram" content="no-cache" />
    <meta http-equiv="cache-control" content="no-cache, must-revalidate" />
    <meta http-equiv="expires" content="0" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" id="viewport" />
    <link rel="stylesheet" href="../css/default.css" />
</head>
<body>
<div class="main">
    <div class="top">
        <!--TAB页面标签-->
        <div class="shang">
            <h1 class="myTitle whiteColor" id="title_1">万豪酒店工程管家<p class="hx" id="hx_1"></p></h1>
        </div>
        <div style="clear: both;"></div>
    </div>
    <div class="content_1">
        <div class="center">
            <table id="gnInfo" class="deviceHistoryData info" cellpadding="0" cellspacing="0">
                <div class="airTitle title_info">
                    <img src="../img/history_2.png" /><span class="itemName">历史数据</span>
                </div>
                <div class="down"></div>
                <tr co>
                    <td>序号</td>
                    <td>温度</td>
                    <td>湿度</td>
                    <td>设备时间</td>
                    <!--<td>记录时间</td>-->
                </tr>
            </table>
            <!--加载更多按钮-->
            <div class="js-load-more">加载更多</div>
            <!--<div class="bottom-menu">
                <button class="statusBtn" onclick="window.location.href='status_list.html'">实时数据</button>
                <button class="deviceWarnBtn" onclick="window.location.href='warn_list.html?item=冷库'">报警数据</button>
                <button class="reportBtn" onclick="window.location.href='report.html?item=冷库'">报表数据</button>
            </div>-->
            <div class="bottom-menu title_info">
                <ul>
                    <li class="statusData" onclick="window.location.href='status_list.html'"><img src="../img/status_1.png" /><br />实时数据</li>
                    <li class="historyData" onclick="window.location.href='device_history.html?item=冷库'"><img src="../img/history_1.png" /><br />历史记录</li>
                    <li class="warnData" onclick="window.location.href='warn_list.html?item=冷库'"><img src="../img/warn_1.png" /><br />报警数据</li>
                    <li class="reportData" onclick="window.location.href='report.html?item=冷库'"><img src="../img/report_1.png" /><br />报表数据</li>
                </ul>
            </div>
        </div>
    </div>
</div>
</body>
<script type="text/javascript" src="../js/lib/jquery-2.0.3.min.js"></script>
<script type="text/javascript" src="../js/Common.js"></script>
<script type="text/javascript">
    //<![CDATA[
    $(function () {
        $(".bottom-menu li").removeClass('myActive');
        $(".bottom-menu .historyData").addClass('myActive');
        $(".bottom-menu .historyData img").attr('src', '../img/history_2.png');
        var counter = 0;
        var pageStart = 0;
        var pageSize = 15;
        /*首次加载*/
        getData(pageStart, pageSize);
        /*监听加载更多*/
        $(".js-load-more").click(function () {
            counter++;
            pageStart = counter * pageSize;
            getData(pageStart, pageSize);
        });
    });
    var num = 0;
    function getData(offset, size) {
        var item = getQueryString('item');
        $(".itemName").text("历史数据");
        $.ajax({
            type: "post",
            url: "/interface/getDeviceHistoryData.json",
            dataType: "json",
            data: {item: item, offset: offset, limit: size},
            success: function (res) {
                console.log(res);
                var rowHtml = "";
                if (res != null && res != '' && res.code == 200) {
                    $(".itemName").text(item + "历史数据");
                    var data = res.t.result;
                    var total = res.t.total;
                    num += data.length;
                    for (var i in data) {
                        rowHtml += "<tr>";
                        rowHtml += "<td>" + data[i].id + "</td>";
                        rowHtml += "<td>" + data[i].value + "℃</td>";
                        rowHtml += "<td>" + data[i].value2 + "%</td>";
                        rowHtml += "<td>" + new Date(data[i].dateTime).pattern("yyyy-MM-dd HH:mm:ss") + "</td>";
                        //rowHtml += "<td>" + new Date(data[i].createTime).pattern("yyyy-MM-dd HH:mm:ss") + "</td>";
                        rowHtml += "</tr>";
                    }
                    $(".deviceHistoryData").append(rowHtml);
                    if (num < total) {
                        $(".js-load-more").show();
                    } else {
                        $(".js-load-more").hide();
                    }
                } else {
                    $(".deviceHistoryData").append("<tr><td colspan='5'>暂无数据</td></tr>");
                }
            }
        });
    }
    //]]>
</script>
</html>