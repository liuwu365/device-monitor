<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title></title>
    <meta name="format-detection" content="telephone=no" />
    <meta http-equiv="x-rim-auto-match" content="none"/>
    <meta http-equiv="pragram" content="no-cache"/>
    <meta http-equiv="cache-control" content="no-cache, must-revalidate"/>
    <meta http-equiv="expires" content="0"/>
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" id="viewport" />
    <link rel="stylesheet" href="../css/default.css" />
    <style type="text/css">
        table tr{ background:#FFFFFF; }
        table thead tr{ background:#F2F2F2; }
        table tbody tr:nth-child(2n){ background:#F2F2F2; }
    </style>
</head>
<body>
<div class="main">
    <div class="top">
        <div class="shang">
            <h1 class="title" id="title_1" onclick="getWarnData('冷库')">冷库报警<p class="hx" id="hx_1"></p></h1>
            <h1 class="title" id="title_2" onclick="getWarnData('污水')">污水报警<p class="hx" id="hx_2"></p></h1>
            <h1 class="title" id="title_3" onclick="getWarnData('水箱')">水箱报警<p class="hx" id="hx_3"></p></h1>
            <h1 class="title" id="title_4" onclick="getWarnData('锅炉')">锅炉报警<p class="hx" id="hx_4"></p></h1>
        </div>
        <div style="clear: both;"></div>
    </div>
    <div class="content_1">
        <div id="common" class="center">
            <div class="pvg">
                <div class="airTitle title_info">
                    <img src="../img/phone_icon_P.png" /><span>冷库一仓</span>
                </div>
                <div class="down"></div>
                <table id="pvgInfo" class="coldWarn info" cellpadding="0" cellspacing="0">
                    <thead>
                    <tr>
                        <td>序号</td>
                        <td>温度</td>
                        <td>报警类型</td>
                        <td>时间</td>
                        <td>处理状态</td>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="content_2">
        <div class="center">
            <table class="sewageWarn info" cellpadding="0" cellspacing="0">
                <thead>
                <tr>
                    <td>序号</td>
                    <td>水位</td>
                    <td>报警类型</td>
                    <td>时间</td>
                    <td>处理状态</td>
                </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
    <div class="content_3">
        <div class="center">
            <table class="waterWarn info" cellpadding="0" cellspacing="0">
                <thead>
                <tr>
                    <td>序号</td>
                    <td>水位</td>
                    <td>报警类型</td>
                    <td>时间</td>
                    <td>处理状态</td>
                </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
    <div class="content_4">
        <div class="center">
            <table class="boiler info" cellpadding="0" cellspacing="0">
                <thead>
                <tr>
                    <td>序号</td>
                    <td>温度</td>
                    <td>报警类型</td>
                    <td>时间</td>
                    <td>处理状态</td>
                </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
    <div class="bottom-menu">
        <button class="statusBtn" onclick="window.location.href='status_list.html'">实时数据</button>
        <button class="deviceHistoryBtn" onclick="window.location.href='device_history.html?item=冷库'">历史数据</button>
        <button class="reportBtn" onclick="window.location.href='report.html?item=冷库'">报表数据</button>
    </div>
</div>
</body>
<script type="text/javascript" src="../js/lib/jquery-2.0.3.min.js"></script>
<script type="text/javascript" src="../js/TabChange.js"></script>
<script type="text/javascript" src="../js/Common.js"></script>
<script type="application/javascript">
    //<![CDATA[
    $(function () {
        getWarnData('冷库'); //默认加载第一个冷库
    });
    function getWarnData(item) {
        $.ajax({
            type: "post",
            url: "/interface/getWarnRecordData.json",
            dataType: "json",
            data: {item: item, offset: 0, limit: 30},
            success: function (res) {
                console.log(res);
                var rowHtml = "";
                if (res != null && res != '' && res.code == 200) {
                    var data = res.t.result;
                    var warnTypePrefix = "";
                    if (item == '冷库' || item == '锅炉') {
                        warnTypePrefix = "温度";
                    } else if (item == '污水' || item == '水箱') {
                        warnTypePrefix = "水位";
                    }
                    for (var i in data) {
                        rowHtml += "<tr>";
                        rowHtml += "<td>" + data[i].id + "</td>";
                        rowHtml += "<td>" + data[i].value + (warnTypePrefix == '温度' ? '℃' : 'cm') + "</td>";
                        rowHtml += "<td>" + warnTypePrefix + (data[i].warnType == 1 ? '偏低' : '偏高') + "</td>";
                        rowHtml += "<td>" + new Date(data[i].createTime).pattern("yyyy-MM-dd HH:mm:ss") + "</td>";
                        rowHtml += "<td>" + (data[i].status == 1 ? '待处理' : data[i].status == 2 ? '处理中' : '已处理') + "</td>";
                        rowHtml += "</tr>";
                    }
                    help(item, rowHtml);
                } else {
                    rowHtml = "<tr><td colspan='5'>暂无数据</td></tr>";
                    help(item, rowHtml);
                }
            }
        });
    }
    function help(item, rowHtml) {
        if (item == '冷库') {
            $(".coldWarn tbody").html(rowHtml);
        } else if (item == '污水') {
            $(".sewageWarn tbody").html(rowHtml);
        } else if (item == '水箱') {
            $(".waterWarn tbody").html(rowHtml);
        } else if (item == '锅炉') {
            $(".boiler tbody").html(rowHtml);
        }
    }
    //]]>
</script>
</html>